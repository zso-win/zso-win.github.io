import{l as P,d as E,r as v,i as I,y as j,I as O,W as S,o as y,p as L,t as R,X as k,h as u,Y as x,Z as _,_ as C}from"./index-0aa85215.js";const M=P&&"loading"in document.createElement("img"),z=(e={})=>{var n;const{root:a=null}=e;return{hash:`${e.rootMargin||"0px 0px 0px 0px"}-${Array.isArray(e.threshold)?e.threshold.join(","):(n=e.threshold)!==null&&n!==void 0?n:"0"}`,options:Object.assign(Object.assign({},e),{root:(typeof a=="string"?document.querySelector(a):a)||document.documentElement})}},m=new WeakMap,f=new WeakMap,b=new WeakMap,N=(e,n,a)=>{if(!e)return()=>{};const i=z(n),{root:o}=i.options;let l;const h=m.get(o);h?l=h:(l=new Map,m.set(o,l));let c,s;l.has(i.hash)?(s=l.get(i.hash),s[1].has(e)||(c=s[0],s[1].add(e),c.observe(e))):(c=new IntersectionObserver(d=>{d.forEach(g=>{if(g.isIntersecting){const w=f.get(g.target),p=b.get(g.target);w&&w(),p&&(p.value=!0)}})},i.options),c.observe(e),s=[c,new Set([e])],l.set(i.hash,s));let t=!1;const r=()=>{t||(f.delete(e),b.delete(e),t=!0,s[1].has(e)&&(s[0].unobserve(e),s[1].delete(e)),s[1].size<=0&&l.delete(i.hash),l.size||m.delete(o))};return f.set(e,r),b.set(e,a),r},T=Object.assign({alt:String,height:[String,Number],imgProps:Object,previewedImgProps:Object,lazy:Boolean,intersectionObserverOptions:Object,objectFit:{type:String,default:"fill"},previewSrc:String,fallbackSrc:String,width:[String,Number],src:String,previewDisabled:Boolean,loadDescription:String,onError:Function,onLoad:Function},_),$=E({name:"Image",props:T,inheritAttrs:!1,setup(e){const n=v(null),a=v(!1),i=v(null),o=I(C,null),{mergedClsPrefixRef:l}=o||j(e),h={click:()=>{if(e.previewDisabled||a.value)return;const t=e.previewSrc||e.src;if(o){o.setPreviewSrc(t),o.setThumbnailEl(n.value),o.toggleShow();return}const{value:r}=i;r&&(r.setPreviewSrc(t),r.setThumbnailEl(n.value),r.toggleShow())}},c=v(!e.lazy);O(()=>{var t;(t=n.value)===null||t===void 0||t.setAttribute("data-group-id",(o==null?void 0:o.groupId)||"")}),O(()=>{if(e.lazy&&e.intersectionObserverOptions){let t;const r=S(()=>{t==null||t(),t=void 0,t=N(n.value,e.intersectionObserverOptions,c)});y(()=>{r(),t==null||t()})}}),S(()=>{var t;e.src,(t=e.imgProps)===null||t===void 0||t.src,a.value=!1});const s=v(!1);return L(k,{previewedImgPropsRef:R(e,"previewedImgProps")}),Object.assign({mergedClsPrefix:l,groupId:o==null?void 0:o.groupId,previewInstRef:i,imageRef:n,showError:a,shouldStartLoading:c,loaded:s,mergedOnClick:t=>{var r,d;h.click(),(d=(r=e.imgProps)===null||r===void 0?void 0:r.onClick)===null||d===void 0||d.call(r,t)},mergedOnError:t=>{if(!c.value)return;a.value=!0;const{onError:r,imgProps:{onError:d}={}}=e;r==null||r(t),d==null||d(t)},mergedOnLoad:t=>{const{onLoad:r,imgProps:{onLoad:d}={}}=e;r==null||r(t),d==null||d(t),s.value=!0}},h)},render(){var e,n;const{mergedClsPrefix:a,imgProps:i={},loaded:o,$attrs:l,lazy:h}=this,c=(n=(e=this.$slots).placeholder)===null||n===void 0?void 0:n.call(e),s=this.src||i.src,t=u("img",Object.assign(Object.assign({},i),{ref:"imageRef",width:this.width||i.width,height:this.height||i.height,src:this.showError?this.fallbackSrc:h&&this.intersectionObserverOptions?this.shouldStartLoading?s:void 0:s,alt:this.alt||i.alt,"aria-label":this.alt||i.alt,onClick:this.mergedOnClick,onError:this.mergedOnError,onLoad:this.mergedOnLoad,loading:M&&h&&!this.intersectionObserverOptions?"lazy":"eager",style:[i.style||"",c&&!o?{height:"0",width:"0",visibility:"hidden"}:"",{objectFit:this.objectFit}],"data-error":this.showError,"data-preview-src":this.previewSrc||this.src}));return u("div",Object.assign({},l,{role:"none",class:[l.class,`${a}-image`,(this.previewDisabled||this.showError)&&`${a}-image--preview-disabled`]}),this.groupId?t:u(x,{theme:this.theme,themeOverrides:this.themeOverrides,clsPrefix:a,ref:"previewInstRef",showToolbar:this.showToolbar,showToolbarTooltip:this.showToolbarTooltip},{default:()=>t}),!o&&c)}});export{$ as N};
